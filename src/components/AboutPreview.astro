---
import site from '../content/site-config.json';

const about = (site as any).aboutPreview ?? {};

const heading: string = about.heading ?? "And that's a great thing!";
const body: string =
	about.body ??
	"Sarah Jess Spencer is the founder of SJS Communications, and she is the idea-machine behind every strategy that SJS plans and executes. You have her individual attention when you decide to work with SJS.";
---

<section aria-labelledby="about-preview-heading" class="relative overflow-hidden" id="about-preview-section">
	<!-- Background layers for effect -->
	<div class="absolute inset-0" id="about-bg-container">
		<!-- Base background -->
		<div
			id="about-bg-base"
			class="absolute inset-0 w-[110%] h-[110%] -left-[5%] -top-[5%] bg-cover bg-center will-change-transform"
			style="background-image: url('/assets/images/about-background.jpg');"
		></div>
		<!-- Fixed circle layers - large circles centered on page -->
		<div
			id="about-circle-1"
			class="absolute rounded-full overflow-hidden will-change-transform pointer-events-none"
			style="width: 1800px; height: 1800px; left: 50%; top: 50%; transform: translate(-50%, -50%); background-image: url('/assets/images/about-background.jpg'); background-size: 100% 100%; background-position: center;"
		></div>
		<div
			id="about-circle-2"
			class="absolute rounded-full overflow-hidden will-change-transform pointer-events-none"
			style="width: 1500px; height: 1500px; left: 50%; top: 50%; transform: translate(-50%, -50%); background-image: url('/assets/images/about-background.jpg'); background-size: 120% 120%; background-position: center;"
		></div>
		<div
			id="about-circle-3"
			class="absolute rounded-full overflow-hidden will-change-transform pointer-events-none"
			style="width: 1200px; height: 1200px; left: 50%; top: 50%; transform: translate(-50%, -50%); background-image: url('/assets/images/about-background.jpg'); background-size: 150% 150%; background-position: center;"
		></div>
	</div>

	<!-- Content with white box -->
	<div class="relative mx-auto max-w-[1400px] px-[4vw] py-32 sm:py-40 lg:py-52 z-10">
		<div class="mx-auto max-w-3xl">
			<div class="bg-white p-10 sm:p-14 lg:p-16 text-center">
				<h2 id="about-preview-heading" class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-normal font-serif text-slate-900">
					WE'RE SMALL, LIKE <em>REALLY</em> SMALL&hellip;
				</h2>
				<p class="mt-6 sm:mt-8 text-sm sm:text-base md:text-lg font-medium text-slate-800 leading-relaxed">
					{heading} {body}
				</p>
			</div>
		</div>
	</div>

	<script>
		const section = document.getElementById('about-preview-section');
		const bgBase = document.getElementById('about-bg-base');
		const circle1 = document.getElementById('about-circle-1');
		const circle2 = document.getElementById('about-circle-2');
		const circle3 = document.getElementById('about-circle-3');

		if (section && bgBase && circle1 && circle2 && circle3) {
			let mouseX = 0.5;
			let mouseY = 0.5;
			let baseX = 0.5, baseY = 0.5;
			let c1X = 0.5, c1Y = 0.5;
			let c2X = 0.5, c2Y = 0.5;
			let c3X = 0.5, c3Y = 0.5;

			section.addEventListener('mousemove', (e) => {
				const rect = section.getBoundingClientRect();
				mouseX = (e.clientX - rect.left) / rect.width;
				mouseY = (e.clientY - rect.top) / rect.height;
			});

			section.addEventListener('mouseleave', () => {
				mouseX = 0.5;
				mouseY = 0.5;
			});

			function animate() {
				// Different interpolation speeds for each layer
				baseX += (mouseX - baseX) * 0.05;
				baseY += (mouseY - baseY) * 0.05;
				c1X += (mouseX - c1X) * 0.03;
				c1Y += (mouseY - c1Y) * 0.03;
				c2X += (mouseX - c2X) * 0.07;
				c2Y += (mouseY - c2Y) * 0.07;
				c3X += (mouseX - c3X) * 0.12;
				c3Y += (mouseY - c3Y) * 0.12;

				// Move base background
				const bgOffsetX = (baseX - 0.5) * 30;
				const bgOffsetY = (baseY - 0.5) * 30;
				bgBase.style.transform = `translate(${bgOffsetX}px, ${bgOffsetY}px)`;

				// Move only the background-position inside fixed circles (creates displacement)
				// Each circle moves at a different rate, creating visible seams
				const c1OffsetX = (c1X - 0.5) * 60;
				const c1OffsetY = (c1Y - 0.5) * 60;
				circle1.style.backgroundPosition = `calc(50% + ${c1OffsetX}px) calc(50% + ${c1OffsetY}px)`;

				const c2OffsetX = (c2X - 0.5) * 45;
				const c2OffsetY = (c2Y - 0.5) * 45;
				circle2.style.backgroundPosition = `calc(50% + ${c2OffsetX}px) calc(50% + ${c2OffsetY}px)`;

				const c3OffsetX = (c3X - 0.5) * 25;
				const c3OffsetY = (c3Y - 0.5) * 25;
				circle3.style.backgroundPosition = `calc(50% + ${c3OffsetX}px) calc(50% + ${c3OffsetY}px)`;

				requestAnimationFrame(animate);
			}

			// Respect reduced motion preference
			if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
				animate();
			}
		}
	</script>
</section>
